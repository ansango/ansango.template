---
/**
 * ğŸ“ CollectionDefault Template
 * 
 * @description Default template for collection index pages.
 * Displays paginated list of entries with title, description, and navigation.
 * 
 * @usage
 * ```astro
 * <CollectionDefault
 *   collection="blog"
 *   entries={blogEntries}
 *   page={1}
 *   isIndex={true}
 *   meta={blogMeta}
 * />
 * ```
 * 
 * @compatible
 * - ğŸ”— Uses Link for entry navigation
 * - ğŸ“ Entry component for previews
 * - ğŸ“„ Pagination component for navigation
 * - ğŸ¯ LayoutDefault wrapper
 */
import { Link } from "@/components/atoms";
import { LayoutDefault } from "@/components/layout";
import { Entry, Pagination } from "@/components/molecules";
import type { CollectionName, Meta } from "@/content.config";
import {
  type Entry as EntryType,
  getPagination,
  type Entries,
} from "@/lib/collections";

interface Props {
  collection: CollectionName;
  entries: Entries;
  page: number;
  entriesPerPage: number;
  isIndex: boolean;
  meta: Meta;
}

const { entries, page, isIndex, meta, collection } = Astro.props;

const { currentPage, paginatedEntries, totalPages } = getPagination<EntryType>({
  isIndex,
  entries,
  page,
  entriesPerPage: meta.entriesPerPage,
});
---

<LayoutDefault {...meta} type="main">
  <div class="border-divider border-b-[1px]">
    <h1 class="capitalize">{collection}</h1>
    <p class="text-muted">
      {meta.description}
    </p>
  </div>
  <ul>
    {
      paginatedEntries.map((entry, i) => (
        <li
          class={`border-divider list-none py-4 [&:not(:last-child)]:border-b-[1px]`}
        >
          <Link
            href={`/${entry.collection}/${entry.id}`}
            className="space-y-1 group"
          >
            <Entry entry={entry} />
          </Link>
        </li>
      ))
    }
  </ul>
  <Pagination
    {currentPage}
    {totalPages}
    prevUrl={`/${collection}${currentPage - 1 !== 1 ? "/" + (currentPage - 1) : ""}/`}
    nextUrl={`/${collection}/${currentPage + 1}/`}
  />
</LayoutDefault>
