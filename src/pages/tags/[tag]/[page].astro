---
import { site } from "@/constants";
import { LayoutDefault } from "@/components/layout";
import { getCollectionsByTag } from "@/lib/collections";
import { getTagStaticPathsPage } from "@/lib/astro";
import {
  TagCollectionsEntries,
  TagContainer,
  TagHero,
  TagPagination,
} from "@/components/organisms/tags/[tag]";

export { getTagStaticPathsPage as getStaticPaths };

const { page, tag } = Astro.params;
const entries = await getCollectionsByTag(tag);
const meta = site.pages.tags;
const isIndex = false;

if (!entries) return Astro.redirect("/");
---

<LayoutDefault {...meta} type="main">
  <TagHero {tag} entriesCount={entries.length} />
  <TagContainer>
    <TagCollectionsEntries {entries} {isIndex} {page} slot="content" />
  </TagContainer>
  <TagPagination {entries} {tag} {isIndex} {page} slot="pagination" />
</LayoutDefault>
